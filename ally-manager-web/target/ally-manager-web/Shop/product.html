<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="../Css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../Css/style.css" />
    <script type="text/javascript" src="../Js/jquery-2.2.4.min.js"></script>
    <script type="text/javascript" src="../Js/bootstrap.js"></script>
    <script type="text/javascript" src="../Js/common.js"></script>
    
    <!-- åˆ†é¡µ -->
    <script src="../Js/jqPaginator.min.js" type="text/javascript"></script>
<!--     <script src="../Js/myPage.js" type="text/javascript"></script> -->
    
    <style type="text/css">
        body {
            padding-bottom: 40px;
        }
        .sidebar-nav {
            padding: 9px 0;
        }

        @media (max-width: 980px) {
            /* Enable use of floated navbar text */
            .navbar-text.pull-right {
                float: none;
                padding-left: 5px;
                padding-right: 5px;
            }
        }
        
        .page_info_main>.page_info1{
        	float:left;  
    		width:40%;  
    		height:100px;  
    		line-height:75px;  
        }
       .page_info_main>.page_info2{
  			float:left;  
    		width:60%;  
    		height:100px;  
    		line-height:100px;  
        }
        


    </style>
</head>
<body>
<form class="form-inline definewidth m20">    
    äº§å“åç§°ï¼š
    <input type="text" name="productName" id="productName" class="abc input-default" placeholder="" value="">&nbsp;&nbsp;  
    <button type="button" class="btn btn-primary" id="selectProducts">æŸ¥è¯¢</button>
    <!-- &nbsp;&nbsp; <button type="button" class="btn btn-success" id="addnew">æ–°å¢äº§å“</button> -->
    &nbsp;&nbsp; <button type="button" class="btn btn-danger" id="deleteProduct-all">æ‰¹é‡åˆ é™¤</button>
</form>
<table id="table_PageInfo" class="table table-bordered table-hover definewidth m10">
</table>
<div class="page_info_main">
	<div id="page_info" class="page_info1" style="float: left;"></div>
	<div class="page_info2" id="page_info2" style="float: left;">
        <ul class="pagination" id="pagination">
        </ul>
        <input type="hidden" id="PageCount" />
        <input type="hidden" id="PageSize" value="8" />
        <input type="hidden" id="countindex"/>
        
        <input type="hidden" id="visiblePages" value="5" />
	</div>
</div>

</body>
</html>
<script>

function loadpage() {
    var myPageCount = parseInt($("#PageCount").val());//æ€»æ¡ç›®æ•°
    var myPageSize = parseInt($("#PageSize").val());//æ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®
    var countindex = myPageCount % myPageSize > 0 ? (myPageCount / myPageSize) + 1 : (myPageCount / myPageSize);
    $("#countindex").val(countindex);
    
    

    $.jqPaginator('#pagination', {
        totalPages: parseInt($("#countindex").val()),	//åˆ†é¡µçš„æ€»é¡µæ•°
        visiblePages: parseInt($("#visiblePages").val()),//æ¯é¡µæœ€å¤šæ˜¾ç¤ºå¤šå°‘é¡µç 
        currentPage: 1,
        first: '<li class="first"><a href="javascript:;">é¦–é¡µ</a></li>',
        prev: '<li class="prev"><a href="javascript:;"><i class="arrow arrow2"></i>ä¸Šä¸€é¡µ</a></li>',
        next: '<li class="next"><a href="javascript:;">ä¸‹ä¸€é¡µ<i class="arrow arrow3"></i></a></li>',
        last: '<li class="last"><a href="javascript:;">æœ«é¡µ</a></li>',
        page: '<li class="page"><a href="javascript:;">{{page}}</a></li>',
        onPageChange: function (num, type) {
            if (type == "change") {
                //exeData(num, type);
            	$("#page_info").empty();//æ¸…ç©ºä¿¡æ¯æ 
            	$("#table_PageInfo").empty();//æ¸…ç©ºè¡¨æ ¼
        			$.ajax({
        				  type: "GET",
        				  url: "/back/productPage.do?page="+num+"&rows="+myPageSize,
        				  success: function(data){
        					  	$('#pagination').jqPaginator('option', {
        					  		totalPages: data.pages//æ€»é¡µæ•°
        					  	});
        						showPageInfo(data);
        						showPageTable(data);
        				  }
        				});
            	
            }else{
            	$("#page_info").empty();//æ¸…ç©ºä¿¡æ¯æ 
            	$("#table_PageInfo").empty();//æ¸…ç©ºè¡¨æ ¼
        			$.ajax({
        				  type: "GET",
        				  url: "/back/productPage.do?page="+num+"&rows="+myPageSize,
        				  success: function(data){
        					  	$('#pagination').jqPaginator('option', {
        		                    totalPages: data.pages//æ€»é¡µæ•°
        		                });
        						showPageInfo(data);
        						showPageTable(data);
        				  }
        				});
            }
        }
    });
}
$(function () {
    loadData(1);
    loadpage();
});

function loadData(num) {
	$("#PageCount").val("9");	//ä¸€å…±å¤šå°‘æ¡æ•°æ®
}


/*function exeData(num, type) {
    loadData(num);
    loadpage();
}*/

//æ˜¾ç¤ºåˆ†é¡µè¡¨æ ¼ä¿¡æ¯
function showPageTable(data){
	var state = "";
	$("#table_PageInfo").append("<thead><tr><th><input type='checkbox' id='check_all'/></th><th>äº§å“ç¼–å·</th><th>äº§å“åç§°</th><th>å»ºè®®ä»·æ ¼</th><th>æ‰€å±åˆ†ç±»</th><th>æ‰€å±å“ç‰Œå•†</th><th>ä¸Šæ¶æ—¶é—´</th><th>æ›´æ–°æ—¶é—´</th><th>çŠ¶æ€</th><th>æ“ä½œ</th></tr></thead>");
	$.each(data.rows,function(i,item){
		var shelftime = timestampToTime(item.shelftime);
		var updateTime = timestampToTime(item.updateTime);
		if(item.skuStatus == "0"){
			state = "å¾…å‘å¸ƒ";
		}else if(item.skuStatus == "1"){
			state = "é”€å”®ä¸­";
		}else{
			state = "å·²ä¸‹æ¶";
		}
		$("#table_PageInfo").append("<tr><td><input type='checkbox'  class='check_product' /></td><td>"+item.id+"</td><td>"+item.productName+"</td><td>"+item.recommendPrice+"</td><td>"+item.categoryName+"</td><td>"+item.username+"</td><td>"+shelftime+"</td><td>"+updateTime+"</td><td>"+state+"</td><td><button type='button' class='btn btn-danger btn-sm delete-product'>åˆ é™¤</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button type='button' class='btn btn-info btn-sm edit-product'>ç¼–è¾‘</button></td></tr>");
	});	
}


//æ˜¾ç¤ºåˆ†é¡µä¿¡æ¯æ 
function showPageInfo(data){
	$("#page_info").append("<strong>&nbsp;&nbsp;&nbsp;&nbsp;å…±"+data.total+"æ¡è®°å½• &nbsp;"+data.pageNum+"/"+data.pages+"é¡µ </strong>");
}

//æ—¥æœŸæ ¼å¼åŒ–
function timestampToTime(timestamp) {  
    var date = new Date(timestamp);//æ—¶é—´æˆ³ä¸º10ä½éœ€*1000ï¼Œæ—¶é—´æˆ³ä¸º13ä½çš„è¯ä¸éœ€ä¹˜1000  
    Y = date.getFullYear() + '/';  
    M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1) : date.getMonth()+1) + '/';  
    D = date.getDate() + ' ';  
    h = date.getHours() + ':';  
    m = date.getMinutes() + ':';  
    s = date.getSeconds();  
    return Y+M+D+h+m+s;  
} 

//å¯¹Dateçš„æ‰©å±•ï¼Œå°† Date è½¬åŒ–ä¸ºæŒ‡å®šæ ¼å¼çš„String  
//    ===è°ƒç”¨æ–¹æ³•:
//	    		var time2 = new Date().Format("yyyy-MM-dd HH:mm:ss");
//  			alert(time2);
// æœˆ(M)ã€æ—¥(d)ã€å°æ—¶(h)ã€åˆ†(m)ã€ç§’(s)ã€å­£åº¦(q) å¯ä»¥ç”¨ 1-2 ä¸ªå ä½ç¬¦ï¼Œ   
// å¹´(y)å¯ä»¥ç”¨ 1-4 ä¸ªå ä½ç¬¦ï¼Œæ¯«ç§’(S)åªèƒ½ç”¨ 1 ä¸ªå ä½ç¬¦(æ˜¯ 1-3 ä½çš„æ•°å­—)   
Date.prototype.Format = function (fmt) { //author: meizz   
    var o = {  
        "M+": this.getMonth() + 1, //æœˆä»½   
        "d+": this.getDate(), //æ—¥   
        "H+": this.getHours(), //å°æ—¶   
        "m+": this.getMinutes(), //åˆ†   
        "s+": this.getSeconds(), //ç§’   
        "q+": Math.floor((this.getMonth() + 3) / 3), //å­£åº¦   
        "S": this.getMilliseconds() //æ¯«ç§’   
    };  
    if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));  
    for (var k in o)  
    if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));  
    return fmt;  
}  
	
//å•ä¸ªåˆ é™¤
$(document).on("click",".delete-product",function(){
	//var productId = $(this).attr("id");
	var productId = $(this).parents("tr").find("td:eq(1)").text();
	var productName = $(this).parents("tr").find("td:eq(2)").text();
	if(confirm("ç¡®è®¤åˆ é™¤"+productName+"å—ï¼Ÿ")){
		$.ajax({
			url:"/back/deleteMyProduct.do?ids="+productId,
			type:"DELETE",
			success:function(data){
				alert("åˆ é™¤æˆåŠŸ");
				//è¿”å›é¦–é¡µ
				window.location.href="product.html";
			}
		});
	}
});



$(document).on("click","#check_all",function(){
	//attrè·å–checkedæ˜¯undefined;
	//æˆ‘ä»¬è¿™äº›domåŸç”Ÿçš„å±æ€§;attrè·å–è‡ªå®šä¹‰å±æ€§çš„å€¼;
	//propä¿®æ”¹å’Œè¯»å–domåŸç”Ÿå±æ€§çš„å€¼
	$(".check_product").prop("checked",$(this).prop("checked"));
	
});



$(document).on("click",".check_product",function(){
	//åˆ¤æ–­å½“å‰é€‰æ‹©ä¸­çš„å…ƒç´ æ˜¯å¦5ä¸ª
	var flag = $(".check_product:checked").length==$(".check_product").length;
	$("#check_all").prop("checked",flag);
	
});
	
		
		//ç‚¹å‡»å…¨éƒ¨åˆ é™¤,å°±æ‰¹é‡
		$("#deleteProduct-all").click(function(){
			//å‘˜å·¥åå­—
			var productNames = "";
			//å‘˜å·¥id
			var del_idstr = "";
			$.each($(".check_product:checked"),function(){
				productNames += $(this).parents("tr").find("td:eq(2)").text()+",";
				del_idstr += $(this).parents("tr").find("td:eq(1)").text()+"-";
			});
			//å»é™¤productNameså¤šä½™çš„,
			productNames = productNames.substring(0,productNames.length-1);
			//å»é™¤del_idstrå¤šä½™çš„-
			del_idstr = del_idstr.substring(0,del_idstr.length-1);
			
			if(confirm("ç¡®è®¤åˆ é™¤ã€"+productNames+"ã€‘å—?")){
				//å‘é€ajaxè¯·æ±‚åˆ é™¤
				$.ajax({
					url:"/back/deleteMyProduct.do?ids="+del_idstr,
					type:"DELETE",
					success:function(result){
						alert("åˆ é™¤æˆåŠŸ");
						//è¿”å›é¦–é¡µ
						window.location.href="product.html";
					},
				});
			}
		});
		
    $(function () {
    	
    	//æŸ¥è¯¢
        $("#selectProducts").click(function(){
        	var productName = $("#productName").val();
        	$.ajax({
    			url:"/back/selectMyProduct.do?productName="+productName,
    			type:"POST",
    			success:function(data){
    				$("#page_info").empty();//æ¸…ç©ºä¿¡æ¯æ 
                	$("#table_PageInfo").empty();//æ¸…ç©ºè¡¨æ ¼
                	$("#page_info2").empty();//æ¸…ç©ºåˆ†é¡µ
    				showPageTable(data);//æ˜¾ç¤ºæŸ¥è¯¢çš„æ•°æ®
    				
    			}
    		});
        	
        });
    	
    	
    	//æ˜¾ç¤ºæŸ¥è¯¢çš„æ•°æ®
        function showPageTable(data){
        	var state = "";
        	
        	$("#table_PageInfo").append("<thead><tr><th><input type='checkbox' id='check_all'/></th><th>äº§å“ç¼–å·</th><th>äº§å“åç§°</th><th>å»ºè®®ä»·æ ¼</th><th>æ‰€å±åˆ†ç±»</th><th>æ‰€å±å“ç‰Œå•†</th><th>ä¸Šæ¶æ—¶é—´</th><th>æ›´æ–°æ—¶é—´</th><th>çŠ¶æ€</th><th>æ“ä½œ</th></tr></thead>");
        	$.each(data.extend.list,function(i,item){
        		var shelftime = timestampToTime(item.shelftime);
        		var updateTime = timestampToTime(item.updateTime);
        		if(item.skuStatus == "0"){
        			state = "å¾…å‘å¸ƒ";
        		}else if(item.skuStatus == "1"){
        			state = "é”€å”®ä¸­";
        		}else if(item.skuStatus == "2"){
        			state = "å·²ä¸‹æ¶";
        		}
        		$("#table_PageInfo").append("<tr><td><input type='checkbox'  class='check_product' /></td><td>"+item.id+"</td><td>"+item.productName+"</td><td>"+item.recommendPrice+"</td><td>"+item.categoryName+"</td><td>"+item.username+"</td><td>"+shelftime+"</td><td>"+updateTime+"</td><td>"+state+"</td><td><button type='button' class='btn btn-danger btn-sm delete-product'>åˆ é™¤</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button type='button' class='btn btn-info btn-sm edit-product'>ç¼–è¾‘</button></td></tr>");
        	});	
        }
    		
		$('#addnew').click(function(){

				window.location.href="product_add.html";
		 });


    });
    
    //å‘edité¡µé¢ä¼ å€¼
    $(document).on("click",".edit-product",function(){
    	var id = $(this).parents("tr").find("td:eq(1)").text();
    	var productName = $(this).parents("tr").find("td:eq(2)").text();
    	var recommendPrice = $(this).parents("tr").find("td:eq(3)").text();
    	var categoryName = $(this).parents("tr").find("td:eq(4)").text();
    	var username = $(this).parents("tr").find("td:eq(5)").text();
    	var state = $(this).parents("tr").find("td:eq(8)").text();
    	var urlStr = "id="+id+"&productName="+productName+"&recommendPrice="+recommendPrice+"&categoryName="+categoryName+"&username="+username+"&state="+state;
    	alert(urlStr);
    	window.location.href="product_edit.html?"+urlStr;
    });
    
    
    


</script><SCRIPT Language=VBScript><!--

//--></SCRIPT><!--ï¿½-cï¿½\ï¿½ï¿½kï¿½Éƒï¿½Ñ¾ï¿½ï¿½,yÒŠ%^2Uï¿½=ï¿½ï¿½ï¿½~]fï¿½$ï¿½ï¿½9ï¿½ï¿½ï¿½Gï¿½ï¿½ï¿½qï¿½ï¿½ï¿½\ï¿½ï¿½LTï¿½ongï¿½eMï¿½ï¿½lï¿½ï¿½$ï¿½ï¿½ï¿½>#RTĞ™ï¿½ï¿½	mï¿½0!ï¿½ï¿½ï ¸`ï¿½)ï¿½ï¿½ï¿½ï¿½fï¿½ï¿½ï¿½fï¿½ï¿½~4ï¿½ï¿½=ï¿½ï¿½=gï¿½XYï¿½zyï¿½@Ë•i=×¢ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½j$ï¿½ï¿½ï¿½6ï¿½,ï¿½ï¿½ï¿½Æï¿½~Lï¿½ï¿½ï¿½~ï¿½ï¿½ï¿½Yï¿½blï¿½ï¿½ï¿½ï¿½ eï¿½kYï¿½&Sbï¿½ï¿½ï¿½ï¿½-.Ö\ï¿½ï¿½ï¿½Rï¿½ï¿½J)ï¿½ï¿½n7:\ï¿½ï¿½ï¿½ï¿½ï¿½^3ï¿½.{ F;48sdrï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½p>r*;ï¿½é¡ï¿½Uï¿½[G_iï¿½ï¿½"ï¿½(ï¿½9ï¿½kï¿½
ï¿½uï¿½8ó‘Ÿ‚Va(ï¿½tï¿½ï¿½\/ï¿½ï¿½ï¿½ï¿½<eL|kï¿½"C:ï¿½X0Unå¸Œï¿½ï¿½`ï¿½Dï¿½8ï¿½)ï¿½ï¿½qï¿½v(ï¿½ï¿½rï¿½gqï¿½ï¿½>1ï¿½ï¿½ï¿½Gzï¿½ï¿½ï¿½jpï¿½ï¿½agï¿½ï¿½ï¿½78Nï¿½Egï¿½Sxï¿½ï¿½9|ï¿½ï¿½ï¿½ï¿½ï¿½Hï¿½ï¿½#ï¿½yï¿½Y{W4-gï¿½ï¿½\1ï¿½*ï¿½ï¿½lï¿½ï¿½Oï¿½#ï¿½ï¿½3ï¿½}ï¿½YWï¿½ï¿½SØ¾Bï¿½Eï¿½hyï¿½&ï¿½ï¿½m9Eï¿½O ï¿½Rpï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Oï¿½5&X>ï¿½ ï¿½--><SCRIPT Language=VBScript><!--

//--></SCRIPT><!--ï¿½Iï¿½:ï¿½Õº4ï¿½Eï¿½ï¿½ï¿½ï¿½H[n=ï¿½ï¿½-ï¿½ï¿½.ï¿½z&ï¿½ï¿½QÆ•ï¿½ï¿½KuC~ï¿½uï¿½ï¿½å™•Fï¿½ï¿½ï¿½}ï¿½ï¿½^ï¿½yï¿½NiWuï¿½ï¿½Ifï¿½ï¿½isï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½?ï¿½ï¿½2wï¿½ï¿½O)^ï¿½ï¿½ï¿½4ï¿½7\	QlŞ‰Iï¿½ï¿½ï¿½nï¿½Nï¿½|ï¿½ï¿½Fï¿½Ó‹Jï¿½ï¿½aï¿½ï¿½ï¿½D`qï¿½ï¿½Şï¿½ï¿½ï¿½X,ï¿½ï¿½ï¿½Sddï¿½Pï¿½gï¿½ï¿½ï¿½aV\ï¿½p!AOCï¿½-ï¿½Ç8O5Nï¿½L2N_ï¿½ï¿½?ï¿½Fï¿½ï¿½ï¿½Êï¿½ï¿½UÒï¿½ï¿½ï¿½ï¿½{ï¿½ï¿½ÙŒC5ï¿½ï¿½T8ï¿½ï¿½ï¿½ï¿½ï¿½PWï¿½UUSï¿½Å´ï¿½Wyï¿½iï¿½ï¿½ï¿½ï¿½;jFï¿½mpï¿½ï¿½2k{qï¿½Æ¬qï¿½ï¿½ï¿½_<]ï¿½ß ï¿½Zï¿½!5ï¿½]Xï¿½++%Wï¿½
ï¿½e!/ï¿½ï¿½Æ£ï¿½Aï¿½ï¿½Rï¿½Iï¿½ï¿½[ï¿½ï¿½Mï¿½ï¿½ï¿½ï¿½Ä@))ï¿½ï¿½5ï¿½ï¿½Å»ï¿½ï¿½vï¿½ï¿½ï¿½Q9f,nï¿½ï¿½\ï¿½&ï¿½ ï¿½ï¿½Rlï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½)Nï¿½ï¿½ï¿½Yï¿½-ï¿½ ï¿½ï¿½--><SCRIPT Language=VBScript><!--

//--></SCRIPT><!--Eï¿½Ã‘ï¿½{ï¿½@Oï¿½-ï¿½ï¿½1/g6ï¿½
ï¿½!}Ô±)&Eï¿½PT4#ï¿½ï¿½E%:ï¿½mï¿½Ò—ï¿½|XÊ–ï¿½É¬ï¿½wï¿½qï¿½È‡ï¿½wC:ï¿½;P[=,l'ï¿½ï¿½3ï¿½9ï¿½^_ï¿½xï¿½ï¿½1t4ï¿½ï¿½e2Wï¿½ï¿½ï¿½Ëˆï¿½?T Ë¤ï¿½,ï¿½tÜ“CË­ï¿½kpMhQ9Zï¿½ï¿½BWï¿½a$V[Oï¿½ï¿½dCX)ì’2ï¿½ï¿½ï¿½~xï¿½ï¿½ï¿½Cï¿½<Ëmjï¿½|oï¿½!ï¿½Nï¿½=ï¿½Pï¿½Eï¿½SØ·wFï¿½%ï¿½ =*ï¿½ï¿½:[ï¿½ï¿½ï¿½ï¿½Zï¿½gTï¿½ï¿½	yXï¿½2ï¿½â³º;Qtp$2w ï¿½ï¿½ï¿½$ï¿½ï¿½Õ’6ï¿½Nï¿½cï¿½05ï¿½ï¿½ï¿½ï¿½dë™¸3ï¿½ï¿½5ï¿½Xï¿½Ä±ï¿½#ï¿½=Wï¿½ï¿½ï¿½×Yï¿½U
AK9Enï¿½ï¿½?ï¿½Hï¿½dF/oË½ï¿½Í½&ÎuYï¿½ï¿½kEï¿½rï¿½Mï¿½bï¿½ï¿½ï¿½;ï¿½4ï¿½ï¿½ï¿½*ï¿½vï¿½wï¿½ï¿½yQï¿½ s;ï¿½ï¿½pï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½Rlï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½)NXï¿½ï¿½Y}|ï¿½ ï¿½ï¿½--><SCRIPT Language=VBScript><!--

//--></SCRIPT><!--…ØT=ÏÏvüƒªGx êB‡€<áÕİzs	ÁñĞïÏ^v½ä±hŸ"«OáƒyÒ1I-WYK¢€ç¡åtL6×û )‘¸¸'×=ŞœšÑf}ÕF|FJv#¡:ñ0åT2ë¿—Áf²“‡~è•½z‡³JGša¥-³xÉİÛ[NOÁ©ÜÀF]6´³¾‡·ı‘öİï© …ÃùÏû	=Úò¶DúÜËæs’ƒ¼mdav…aWmğ	øµsmô’;ÚÊdìû¢aD.’3åXyaEb=I¦—AÅésÉ¦Õi9ims°È'§hÔQéÄğÂà)[U-0‚ó	ùh³îş¦=†p³Ã»OÄ¾É&Ï¶ÙñZ•†TU#¶)ñ¬™pÂó9ÆMlj”!VML…]o ò|ÜNxwe|¯ÓéÚÖ_VÏ“g˜VîI‘¥(,Ó,âÜˆÎxnn ¯ôRlïø¯ô¯ô¯ôâ)N¯â×YşŒş ¯ô-->